(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{644:function(e,a,t){Promise.resolve().then(t.bind(t,2388))},2388:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return K}});var l=t(7437),r=t(7907),s=t(8778),i=t(9682),n=t(2265),c=t(3577),d=t(3984),o=t(1622),h=t(398),u=t(8767),m=t(1774),p=t(8364),x=t(3418);let g=async e=>await Promise.all(e.map(e=>(0,c.bW)(e.id))),j=async(e,a)=>{let t=e.matches?e:await (0,c.zR)(e.id),l=(await g(t.scores)).filter(e=>!a||e.match.date.getTime()<=a.getTime()-100);return l.length<1||!l?0:parseFloat((l.reduce((e,a)=>e+a.score,0)/l.length*1).toFixed(2))},y=e=>{let[a,t]=(0,n.useState)();return((0,n.useEffect)(()=>{let a=async()=>{let a=e.player.matches?e.player:await (0,c.zR)(e.player.id);t(await j(a,e.date))};a();let l=(0,c.p7)(a);return()=>{(0,c.y4)(l)}},[]),void 0===a)?(0,l.jsx)(s.aN,{}):(0,l.jsx)(l.Fragment,{children:a})},v={name:"table-theme",tokens:{components:{table:{row:{hover:{backgroundColor:{value:"{colors.blue.20}"}},striped:{backgroundColor:{value:"{colors.blue.10}"}}},header:{color:{value:"var(--amplify-components-tabs-item-active-color)"},fontSize:{value:"{fontSizes.large}"}},data:{fontWeight:{value:"{fontWeights.semibold}"}}}}}},f=async e=>await Promise.all(e.map(e=>(0,c.Wd)(e.id))),S=async e=>{let a=(await f(e.matches)).map(async a=>{let t=a.scores.map(e=>(0,c.bW)(e.id)),l=await Promise.all(t),r=l.find(a=>a.player.id===e.id);if(!r)return!1;let s=await j(e,a.date),i=r.score-s,n=l.find(a=>a.player.id!==e.id);if(!n)return!0;let d=await j(null==n?void 0:n.player,a.date);return i<n.score-d});return(await Promise.all(a)).filter(e=>e).length},w=e=>{let[a,t]=(0,n.useState)([]);return((0,n.useEffect)(()=>{let a=async()=>{let l=(await (0,c.M_)(e.league)).map(async e=>({...e,leaguePoints:await S(e)})),r=await Promise.all(l);r.sort((e,a)=>a.leaguePoints-e.leaguePoints),t(r);let s=(0,c.p7)(async()=>{await a()});return()=>{(0,c.y4)(s)}};a()},[e.league]),0===a.length)?(0,l.jsx)(s.aN,{}):(0,l.jsx)(o.f,{theme:v,colorMode:"light",children:(0,l.jsxs)(h.i,{highlightOnHover:!0,variation:"striped",children:[(0,l.jsx)(u.s,{children:(0,l.jsxs)(m.S,{children:[(0,l.jsx)(p.p,{as:"th",children:"Name"}),(0,l.jsx)(p.p,{as:"th",children:"Handicap"}),(0,l.jsx)(p.p,{as:"th",children:"Points"})]})}),(0,l.jsx)(x.R,{children:a.map(e=>(0,l.jsxs)(m.S,{children:[(0,l.jsx)(p.p,{children:e.name}),(0,l.jsx)(p.p,{children:(0,l.jsx)(y,{player:e})}),(0,l.jsx)(p.p,{children:e.leaguePoints})]},e.id))})]})})};var b=t(3467),T=t(7511),C=t(6820),P=t(4207);let N=e=>{let a=Math.floor(Math.abs(16777215*Math.sin(e.getTime()))).toString(16);for(;a.length<6;)a="0"+a;return"#".concat(a)},E=e=>{var a,t,r,s;return(0,l.jsxs)(T.G,{borderRadius:"15px",padding:"25px",backgroundColor:N(e.match.date),children:[(0,l.jsxs)(C.X,{level:4,children:[null===(t=e.match.players)||void 0===t?void 0:null===(a=t[0])||void 0===a?void 0:a.name," vs ",null===(s=e.match.players)||void 0===s?void 0:null===(r=s[1])||void 0===r?void 0:r.name," - TBD"]}),(0,l.jsxs)(P.x,{as:"div",children:["on ",e.match.date.toLocaleDateString()]})]})},F=e=>{let[a,t]=(0,n.useState)();return((0,n.useEffect)(()=>{(async()=>{var a;let l=e.match.scores.map(e=>(0,c.bW)(e.id)),r=(await Promise.all(l)).find(a=>a.player.id===e.player.id);t(null!==(a=null==r?void 0:r.score)&&void 0!==a?a:"-")})()},[e.match.scores]),void 0===a)?(0,l.jsx)(s.aN,{}):(0,l.jsx)(l.Fragment,{children:a})},M=e=>{let[a,t]=(0,n.useState)();return((0,n.useEffect)(()=>{(async()=>{let a=e.match.scores.map(e=>(0,c.bW)(e.id)),l=(await Promise.all(a)).find(a=>a.player.id===e.player.id);if(!l){t("-");return}let r=await j(e.player,e.match.date);t(l.score-r)})()},[e.match.scores]),void 0===a)?(0,l.jsx)(s.aN,{}):(0,l.jsx)(l.Fragment,{children:a})},D=e=>{let[a,t]=(0,n.useState)(),[r,i]=(0,n.useState)();if((0,n.useEffect)(()=>{(async()=>{let a=e.match.scores.map(e=>(0,c.bW)(e.id)),l=await Promise.all(a),r=l.find(a=>a.player.id===e.player.id);if(r){let a=await j(e.player,e.match.date);t(r.score-a)}else t("-");let s=e.match.players.find(a=>a.id!==e.player.id),n=l.find(a=>a.player.id!==e.player.id);if(n){let a=await j(s,e.match.date);i(n.score-a)}else i("-")})()},[e.match.scores]),void 0===a||void 0===r)return(0,l.jsx)(s.aN,{});let d="-"===a?1e6:a,o="-"===r?1e6:r;return(0,l.jsx)(l.Fragment,{children:d<o?"⭐":d==o?"\uD83D\uDC54":"\uD83D\uDCA9"})},R=e=>(0,l.jsx)(b.Z,{style:{paddingTop:0,paddingLeft:0},children:(0,l.jsx)(o.f,{theme:v,colorMode:"light",children:e.match.scores.length?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(h.i,{highlightOnHover:!0,variation:"striped",caption:"Match on ".concat(e.match.date.toLocaleDateString()),children:[(0,l.jsx)(u.s,{children:(0,l.jsxs)(m.S,{backgroundColor:N(e.match.date),children:[(0,l.jsx)(p.p,{as:"th"}),(0,l.jsx)(p.p,{as:"th",children:e.match.players[0].name}),(0,l.jsx)(p.p,{as:"th",children:e.match.players[1].name})]})}),(0,l.jsxs)(x.R,{children:[(0,l.jsxs)(m.S,{children:[(0,l.jsx)(p.p,{as:"th",children:"Handicap"}),(0,l.jsx)(p.p,{children:(0,l.jsx)(y,{player:e.match.players[0],date:e.match.date})}),(0,l.jsx)(p.p,{children:(0,l.jsx)(y,{player:e.match.players[1],date:e.match.date})})]}),(0,l.jsxs)(m.S,{children:[(0,l.jsx)(p.p,{as:"th",children:"Raw Score"}),(0,l.jsx)(p.p,{children:(0,l.jsx)(F,{player:e.match.players[0],match:e.match})}),(0,l.jsx)(p.p,{children:(0,l.jsx)(F,{player:e.match.players[1],match:e.match})})]}),(0,l.jsxs)(m.S,{children:[(0,l.jsx)(p.p,{as:"th",children:"Adj Score"}),(0,l.jsx)(p.p,{children:(0,l.jsx)(M,{player:e.match.players[0],match:e.match})}),(0,l.jsx)(p.p,{children:(0,l.jsx)(M,{player:e.match.players[1],match:e.match})})]}),(0,l.jsxs)(m.S,{children:[(0,l.jsx)(p.p,{as:"th",children:"Winner"}),(0,l.jsx)(p.p,{children:(0,l.jsx)(D,{player:e.match.players[0],match:e.match})}),(0,l.jsx)(p.p,{children:(0,l.jsx)(D,{player:e.match.players[1],match:e.match})})]})]})]})}):(0,l.jsx)(E,{match:e.match})})}),W=e=>{let[a,t]=(0,n.useState)([]);return((0,n.useEffect)(()=>{let a=async()=>{t(await (0,c.eK)(e.league))};a();let l=(0,c.p7)(a);return()=>{(0,c.y4)(l)}},[e.league]),0===a.length)?(0,l.jsx)(s.aN,{}):(0,l.jsx)(l.Fragment,{children:a.sort((e,a)=>e.date.getTime()-a.date.getTime()).map(e=>(0,l.jsx)(R,{match:e},e.id))})},k=e=>{let[a,t]=(0,n.useState)([]);return((0,n.useEffect)(()=>{let a=async()=>{t(await (0,c.eK)(e.league))};a();let l=(0,c.p7)(a);return()=>{(0,c.y4)(l)}},[e.league]),0===a.length)?(0,l.jsx)(s.aN,{}):(0,l.jsx)(o.f,{theme:v,colorMode:"light",children:(0,l.jsxs)(h.i,{highlightOnHover:!0,variation:"striped",children:[(0,l.jsx)(u.s,{children:(0,l.jsxs)(m.S,{children:[(0,l.jsx)(p.p,{as:"th",children:"Date"}),(0,l.jsx)(p.p,{as:"th",children:"Player"}),(0,l.jsx)(p.p,{as:"th",children:"Vs"})]})}),(0,l.jsx)(x.R,{children:a.sort((e,a)=>e.date.getTime()-a.date.getTime()).map(e=>(0,l.jsxs)(m.S,{children:[(0,l.jsx)(p.p,{color:N(e.date),children:e.date.toLocaleDateString()}),(0,l.jsx)(p.p,{color:N(e.date),children:e.players[0].name}),(0,l.jsx)(p.p,{color:N(e.date),children:e.players[1].name})]},e.id))})]})})};var z=t(8089),_=t(3625),H=t(4686),L=t(3268),O=t(4668);let A=e=>{let{tokens:a}=(0,z.Fg)(),[t,r]=(0,n.useState)(!1),[d,o]=(0,n.useState)(!1),[h,u]=(0,n.useState)(!1),[m,p]=(0,n.useState)([]),[x,g]=(0,n.useState)([]),[j,y]=(0,n.useState)([]),[v,f]=(0,n.useState)(),[S,w]=(0,n.useState)(),[b,T]=(0,n.useState)(),C=!!b||0===b,P=async()=>{p(await (0,c.M_)(e.league)),g(await (0,c.eK)(e.league)),y(await (0,c.Qc)(e.league))};(0,n.useEffect)(()=>{P()},[e.league]);let N=async e=>{T(parseInt(e.target.value))},E=async e=>{let a=e.target.value;f(await (0,c.zR)(a))},F=async e=>{let a=e.target.value;w(await (0,c.Wd)(a))},M=async()=>{if(o(!1),u(!1),r(!0),!C||!S||!v){u(!0),r(!1);return}await (0,c.bZ)(e.league,S,v,b),f(void 0),w(void 0),T(void 0),o(!0),P(),r(!1)};return 0===m.length||0===x.length?(0,l.jsx)(s.aN,{}):(0,l.jsxs)(l.Fragment,{children:[d?(0,l.jsx)(_.v,{variation:"outlined",colorTheme:"success",heading:"Success",children:"Score reported"}):"",h?(0,l.jsx)(_.v,{variation:"outlined",colorTheme:"error",heading:"Error",children:"Failed to report score."}):"",(0,l.jsxs)(H.p,{legend:"Report a score",variation:"outlined",direction:"column",children:[(0,l.jsxs)(i.m,{onChange:E,marginBottom:a.space.medium,label:"Players",size:"large",descriptiveText:"Which player?",labelHidden:!0,children:[(0,l.jsx)("option",{value:"",children:"Select Player"}),m.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,l.jsxs)(i.m,{onChange:F,marginBottom:a.space.medium,label:"Matches",size:"large",descriptiveText:"Select Match",labelHidden:!0,disabled:!v,children:[(0,l.jsx)("option",{value:"title",children:"Select Match"}),x.filter(e=>e.players.find(e=>(null==v?void 0:v.id)===e.id)).filter(e=>e.date.getTime()<Date.now()+6048e5).filter(e=>!j.find(a=>a.match.id===e.id&&a.player.id===(null==v?void 0:v.id))).sort((e,a)=>e.date.getTime()-a.date.getTime()).map(e=>(0,l.jsx)("option",{value:e.id,children:e.date.toLocaleDateString()},e.id))]}),(0,l.jsx)(L.I,{onChange:N,disabled:!S,size:"large",placeholder:"Score over/under par",marginBottom:a.space.medium,id:"score"}),(0,l.jsx)(O.z,{disabled:!C,isFullWidth:!0,isLoading:t,colorTheme:"overlay",size:"large",onClick:()=>M(),children:"Report Score"})]})]})};function B(e){let[a,t]=(0,n.useState)(!0);return((0,n.useEffect)(()=>{(async()=>{await (0,c.M_)(e.league),t(!1)})()}),a)?(0,l.jsx)(s.aN,{}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(A,{league:e.league}),(0,l.jsx)(d.m,{justifyContent:"center",defaultValue:"leaderboard",items:[{label:"Leaderboard",value:"leaderboard",content:(0,l.jsx)(w,{league:e.league})},{label:"Matches",value:"matches",content:(0,l.jsx)(k,{league:e.league})},{label:"Results",value:"results",content:(0,l.jsx)(W,{league:e.league})}]})]})}function K(){let[e,a]=(0,n.useState)([]),[t,d]=(0,n.useState)(),o=(0,r.useRouter)();(0,n.useEffect)(()=>{(async()=>{let e=(await (0,c.NC)()).sort((e,a)=>a.createdAt.getTime()-e.createdAt.getTime());d(e[0]),a(e)})()},[]);let h=a=>{if("create"===a){o.push("/create-league",{scroll:!1});return}let t=e.find(e=>e.id===a);console.log({selectedLeague:t}),d(t)};return e.length&&t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(i.m,{label:"",descriptiveText:"Create a new league or review other leagues",onChange:e=>h(e.target.value),children:[e.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id)),(0,l.jsx)("option",{value:"create",children:"Create a league"})]}),(0,l.jsx)(B,{league:t})]}):(0,l.jsx)(s.aN,{variation:"linear"})}}},function(e){e.O(0,[871,380,171,577,971,69,744],function(){return e(e.s=644)}),_N_E=e.O()}]);